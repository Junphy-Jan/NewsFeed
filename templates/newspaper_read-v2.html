{% extends "base.html" %}

{% block content %}

    <script>
        $(document).ready(function () {
            let min_height = 1000
            let news = $('.paper-news-ov');
            for (let i = 0; i < news.length; i++) {
                console.log("news-" + i + "height: " + $(news[i]).height())
                if ($(news[i]).height() < min_height) {
                    min_height = $(news[i]).height()
                }
            }
            for (let i = 0; i < news.length; i++) {
                if ($(news[i]).height() >= min_height) {
                    $(news[i]).css("height", min_height + 2)
                    $(news[i]).css("overflow", 'hidden')
                }
                console.log("news-" + i + "height: " + $(news[i]).height())
            }

            {#diff_dist = k * title.margin-top + n*lines.margin-top#}
            {# 设margin-top为 x，则距离为 K*标题和正文的margin + 正文之间的margin 即 diff = k*x + n*x #}
            {#let news_content = $($this.children()[1])#}
            {#let content_paragraphs = news_content.children().length#}
            {#margin_top_value = diff_dist /(content_paragraphs - 1 + k)#}
            {#console.log("margin-top: " + margin_top_value)#}
            {#news_content.css("margin-top", 2*margin_top_value)#}
            {#for (let i=1;i<content_paragraphs;i++){#}
            {#    childx = $(news_content.children()[i])#}
            {#    childx.css("margin-top", margin_top_value)#}
            {# } #}
            {#diff_dist = $this.parent().height() - $this.height()#}
            {#console.log("结束 diff_dist: " + diff_dist)#}

        })

        function read_news(id) {
            document.getElementById("news-detail-title").innerHTML = id.children[0].textContent;

            {#删除原有元素#}
            let news_content = document.getElementById("news-detail-content");
            let content_lines = document.getElementsByClassName("news-detail-lines");
            for (let i = content_lines.length - 1; i >= 0; i--) {
                news_content.removeChild(content_lines[i])
            }
            if(id.parentElement.parentElement.className.includes("news-6")){
                let news_content_id = document.getElementById("news-6-content-lines")
                for (let i = 0; i < news_content_id.children.length; i++) {
                    let detail_line = document.createElement("p");
                    detail_line.setAttribute("class", "news-detail-lines");
                    detail_line.innerHTML = news_content_id.children[i].textContent;
                    news_content.appendChild(detail_line);
                }
            }else if (id.parentElement.parentElement.className.includes("news-7")){
                let news_content_id = document.getElementById("news-7-content-lines")
                for (let i = 0; i < news_content_id.children.length; i++) {
                    let detail_line = document.createElement("p");
                    detail_line.setAttribute("class", "news-detail-lines");
                    detail_line.innerHTML = news_content_id.children[i].textContent;
                    news_content.appendChild(detail_line);
                }
            }
            else {
                {# 添加元素 #}
                for (let i = 1; i < id.children.length; i++) {
                    let detail_line = document.createElement("p");
                    detail_line.setAttribute("class", "news-detail-lines");
                    detail_line.innerHTML = id.children[i].textContent;
                    news_content.appendChild(detail_line);
                }
            }
            {#document.getElementById("news-detail-content").innerHTML = id.children[1].textContent;#}
        }
    </script>
    <div class="row">
        <div class="col-md-5 col-lg-5 offset-md-1" id="newspaper_page"
             style="-webkit-transform: scale(0.80); -webkit-transform-origin-y: top; padding-top: 1rem;
                    border: solid 1px">
            <div class="row">
                <div class="col-md-2 col-lg-2 paper-news-x">
                    <a href="#">
                        <div class="paper-news-ov" onclick="read_news(this)">
                            <h5 class="paper-news-ov-title">{{ news_list[0].title }}</h5>
                            <div class="paper-news-ov-lines">
                                {% for line in news_list[0].lines %}
                                    <p class="paper-news-ov-line">{{ line }}</p>
                                {% endfor %}
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-md-2 col-lg-2 paper-news-x">
                    <a href="#">
                        <div class="paper-news-ov" onclick="read_news(this)">
                            <h5 class="paper-news-ov-title">{{ news_list[1].title }}</h5>
                            <div class="paper-news-ov-lines">
                                {% for line in news_list[1].lines %}
                                    <p class="paper-news-ov-line">{{ line }}</p>
                                {% endfor %}
                            </div>
                        </div>
                    </a>
                </div>
                <div class="mid-row">
                    <div class="paper-news-ov">
                    <a href="#">
                        <div class="mid-row-1 paper-news-x" onclick="read_news(this)">
                            <h5 class="paper-news-ov-title">{{ news_list[2].title }}</h5>
                            <div class="paper-news-ov-lines">
                                {% for line in news_list[2].lines %}
                                    <p class="paper-news-ov-line">{{ line }}</p>
                                {% endfor %}
                            </div>
                        </div>
                    </a>
                    <a href="#">
                        <div class="mid-row-2 paper-news-x" onclick="read_news(this)">
                            <h5 class="paper-news-ov-title">{{ news_list[3].title }}</h5>
                            <div class="paper-news-ov-lines">
                                {% for line in news_list[3].lines %}
                                    <p class="paper-news-ov-line">{{ line }}</p>
                                {% endfor %}
                            </div>
                        </div>
                    </a>
                    <a href="#">
                        <div class="mid-row-3 paper-news-x" onclick="read_news(this)">
                            <h5 class="paper-news-ov-title">{{ news_list[4].title }}</h5>
                            <div class="paper-news-ov-lines">
                                {% for line in news_list[4].lines %}
                                    <p class="paper-news-ov-line">{{ line }}</p>
                                {% endfor %}
                            </div>
                        </div>
                    </a>
                    </div>
                </div>

                <div class="col-md-2 col-lg-2 paper-news-x">
                    <a href="#">
                        <div class="paper-news-ov" onclick="read_news(this)">
                            <h5 class="paper-news-ov-title">{{ news_list[5].title }}</h5>
                            <div class="paper-news-ov-lines">
                                {% for line in news_list[5].lines %}
                                    <p class="paper-news-ov-line">{{ line }}</p>
                                {% endfor %}
                            </div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6 col-lg-6">
                    <div class="card bg-white news-6-ov-title">
                        <a href="#">
                            <div class="card-body" onclick="read_news(this)">
                                <h5 class="paper-news-ov-title">{{ news_list[6].title }}</h5>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="col-md-6 col-lg-6">
                    <div class="card bg-white news-7-ov-title">
                        <a href="#">
                            <div class="card-body" onclick="read_news(this)">
                                <h5 class="paper-news-ov-title">{{ news_list[7].title }}</h5>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6 col-lg-6">
                    <div class="card bg-white news-6-ov-content">
                        <div class="card-body">
                                <div class="paper-news-ov-lines" id="news-6-content-lines">
                                    {% for line in news_list[6].lines %}
                                        <p class="paper-news-ov-line">{{ line }}</p>
                                    {% endfor %}
                                </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-lg-6">
                    <div class="card bg-white news-7-ov-content">
                        <div class="card-body">
                                <div class="paper-news-ov-lines" id="news-7-content-lines">
                                    {% for line in news_list[7].lines %}
                                        <p class="paper-news-ov-line">{{ line }}</p>
                                    {% endfor %}
                                </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-5 col-lg-5" id="news_detail">
            <div class="card p-3 bg-white">
                <div class="card-body" id="news-detail">
                    <h3 id="news-detail-title" class="web-news-read-title">{{ news_list[news_idx].title }}</h3>
                    <div id="news-detail-content">
                        {% for line in news_list[news_idx].lines %}
                            <p class="news-detail-lines">{{ line }}</p>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>

{% endblock %}